<p>Images are nothing other than a collection of pixels. And each pixel is nothing other than value for a colour. And any colour can be represented as a combination of red, green, and blue (RGB). </p><figure><img src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-12_17-25-44-d5854190572f3330c9e306fbf2933923.gif"></figure><figure><img src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-12_17-19-35-d1bcbb657bc7436583140c99856b1347.png"></figure><p>You should two import statements at the top. Scipy and PIL will help us work with images. </p><p>The Scipy library contains an image of a racoon under 'miscellaneous' (misc). We an fetch it like so:</p><pre class="prettyprint linenums">img = misc.face()</pre><p>and display it using Matplotlib's <code>.imshow()</code></p><h4><img src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-12_17-33-27-9e2e3bb61614dd8f814429f9f7dd6b50.png"></h4><h4>Challenge</h4><p>What is the data type of <code>img</code>? Also, what is the shape of <code>img</code> and how many dimensions does it have? What is the resolution of the image?</p><p><br></p><p>.</p><p>.</p><p>..</p><p>...</p><p>..</p><p>.</p><p>.</p><p><br></p><p><strong>Solution: An image as a ndarray</strong></p><p>Let us question the nature of our reality and take a look under the surface. Here's what our <strong>"image" </strong>actually looks like:&nbsp; </p><figure><img src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-13_09-28-44-6f41078c913d2304ad5e606add8704e2.png"></figure><p>We can now clearly see that we're dealing with a ndarray. And it's a 3 dimensional array at that.</p><figure><img height="303" src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-12_17-42-09-192012f781f92f80a849dc1ea3212494.png" width="366"></figure><p>There are three matrices stacked on top of each other - one for the red values, one for the green values and one for the blue values. Each matrix has a 768 rows and 1024 columns, which makes sense since 768x1024 is the resolution of the image. </p><p><br></p><h4>Challenge</h4><p>Now can you try and convert the image to black and white? All you need need to do is use a <a href="https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale" rel="noopener noreferrer" target="_blank">formula</a>. </p><figure><img src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-12_17-56-16-aff5999394e88abae2995c6d700a8cb1.png"></figure><p>Y_linear is what we're after - our black and white image. However, this formula only works if our red, green and blue values are between 0 and 1 - namely in sRGB format. Currently the values in our <code>img</code> range from 0 to 255. So:</p><ul><li><p>Divide all the values by 255 to convert them to sRGB. </p></li><li><p>Multiply the sRGB array by the <code>grey_vals</code> array (provided) to convert the image to grayscale.</p></li><li><p>Finally use Matplotlib's <a href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.imshow.html" rel="noopener noreferrer" target="_blank"><code>.imshow()</code></a> with the colormap parameter set to gray <code>cmap=gray</code> to display the result.</p></li></ul><p><br></p><p>.</p><p>.</p><p>..</p><p>...</p><p>..</p><p>.</p><p>.</p><p><br></p><p><strong>Solution: Converting an image to grayscale</strong></p><p>The first step is a division by a scalar</p><pre class="prettyprint linenums">sRGB_array = img / 255</pre><p>Here NumPy will use broadcasting to divide all the values in our ndarray by 255. </p><p>Next, we use matrix multiplication to multiply our two ndarrays together. </p><pre class="prettyprint linenums">grey_vals = np.array([0.2126, 0.7152, 0.0722])</pre><p>These are the values given by the formula above</p><pre class="prettyprint linenums">img_gray = sRGB_array @ grey_vals</pre><p>We can either multiply them together with the @ operator or the <code>.matmul()</code> function.</p><pre class="prettyprint linenums">img_gray = sRGB_array @ grey_vals</pre><pre class="prettyprint linenums">img_gray = np.matmul(sRGB_array, grey_vals)</pre><p>Finally, to show the image we use Matplotlib</p><pre class="prettyprint linenums">plt.imshow(img_gray, cmap='gray')</pre><p>The <code>cmap</code> parameter is important here. If we leave it out the function will not know that is dealing with a black and white image. </p><figure><img height="713" src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-12_18-03-51-46b947197834216ff69717fd4ac7dd58.png" width="439"></figure><h4>Challenge</h4><p>Can you manipulate the images by doing some operations on the underlying ndarrays? See if you can change the values in the ndarray so that:</p><p>1) You flip the grayscale image upside down like so:</p><figure><img src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-13_09-48-42-6da00043154d3fd57f2b979b692125c1.png"></figure><p>2) Rotate the colour image:</p><figure><img src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-13_09-48-48-618965070981a8096f73de791f750b21.png"></figure><p>3) Invert (i.e., solarize) the colour image. To do this you need to convert all the pixels to their "opposite" value, so black (0) becomes white (255).</p><figure><img src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-13_09-48-54-e30020abc219020c9a4c214cc55a6da1.png"></figure><p><br></p><p><br></p><p>.</p><p>.</p><p>..</p><p>...</p><p>..</p><p>.</p><p>.</p><p><br></p><p><strong>Solution:&nbsp;Manipulating the ndarray to change the image</strong></p><p>For the first challenge, all you need to do is reverse the order of the rows and the columns in the NumPy array with the <code>.flip()</code> function:</p><figure><img height="332" src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-13_09-55-11-fefab18ee7919d2c38c006905c90db86.png" width="464"></figure><p>You can display the upside down image in a single line of code:</p><pre class="prettyprint linenums">plt.imshow(np.flip(img_gray), cmap='gray')</pre><p>To rotate the image, all you need to do is rotate the array with <code>.rot90()</code></p><figure><img height="274" src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-13_10-00-59-8f4764f22d74c4902ad3e1a9929330d1.png" width="366"></figure><p>This will rotate our image too:</p><figure><img height="402" src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-13_09-59-10-1110e3ba5c7aceb8342d0fb66228dcb0.png" width="535"></figure><p>Inverting the colour image is a bit more tricky. It involved making use of NumPy's ability to broadcast when doing operations with a scalar. In this case, our scalar is 255 - the maximum value for a pixel in RGB (see gif at the very top). If we subtract the values of our <code>img</code> from 255, then we get the opposite value for each pixel: </p><p><br></p><pre class="prettyprint linenums">solar_img = 255 - img
plt.imshow(solar_img)</pre><p><br></p><h4>Use Your Own Images</h4><p>I've provided a .jpg file in the starting .zip file, so you can try your code out with an image that isn't a racoon ü¶ù. The key is that your image should have 3 channels (red-green-blue). If you use a .png file with 4 channels there are additional pre-processing steps involved to replicate what we're doing here. </p><p>How do you open an image and put it into a NumPy array?</p><figure><img height="358" src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-13_10-29-27-3a3e2d19291e4b76effc62168f2023cd.png" width="694"></figure><p>First, make sure you've added the image to your project. All you need to do is use the PIL&nbsp;library to open the image and then create the ndarray using the image. You should see that your ndarray has 3 dimensions. The shape will be the resolution of your image. </p><figure><img height="226" src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-13_10-31-07-65d5d16e9295629db82713dc42220031.png" width="595"></figure><p>Now feel free to manipulate your own images as you see fit. If you discover something particularly cool, be sure to share in the comments below!&nbsp;üëá I'd love to see your hard work üòé</p><figure><img src="https://udemy-images.s3.amazonaws.com:443/redactor/raw/2020-10-13_10-34-04-6e3c1ebc7c0899aefd0d78ad8e899634.png"></figure><p><br></p>